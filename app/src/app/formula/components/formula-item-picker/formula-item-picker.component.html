<div class="formula-item-picker-container bg-gray">
  <div class="item-picker">
    <div class="columns is-gapless is-mobile">
      <div class="column">
        <div class="category-box" 
          *ngFor="let category of categories"
          [ngClass]="{
            'active': selectedCategoryItem?.categoryId === category.id
          }">
          <div class="columns is-gapless is-mobile">
            <div *ngIf="isExpanded" class="column is-3">
              <div class="category-name-container border-light">
                <p class="category-name no-selectable">{{ category.title }}</p>
              </div>
            </div>
            <div class="column items-column" 
              [ngClass]="{
                'is-12': !isExpanded,
                'is-9': isExpanded
              }">
              <div class="items-box-container">
                <div 
                  class="category-item-container border-light"
                  *ngFor="let item of category.items"
                  [ngClass]="{
                    'active': selectedCategoryItem?.id === item.id
                  }"
                  (click)="onCategoryItemClick(item)">
                  <img [src]="item.img" alt="item-icon" class="item-icon">
                  <p *ngIf="isExpanded" class="item-name no-selectable">{{ item.title }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="column"
        [ngClass]="{
          'is-10': !isExpanded
        }">
        <div class="items-toolbar-container">
          <div *ngIf="isSearchItemSelected(selectedCategoryItem)" class="search-bar-container">
            <div class="columns is-gapless search-content border-regular">
              <div class="column is-10">
                <input type="text" (keyup)="doFilter($event)" placeholder="Buscar...">
              </div>
              <div class="column">
                <div class="search-icon bg-gray no-selectable">
                  <mat-icon>search</mat-icon>
                </div>  
              </div>
            </div>
          </div>

          <div class="toolbox custom-vertical-scroll">
            <div *ngIf="selectedCategoryItem" class="selectable-badges-container">

              <div *ngIf="selectedCategoryItem.slug === 'variables'">
                <div
                  *ngFor="let formula of variables; index as index" 
                  class="pickable-badge no-selectable param numeric-param"
                  [id]="'variable-' + index + 1"
                  [attr.data-payload]="formula | json"
                  [attr.data-type]="'numeric'"
                  draggable="true"
                  (dragstart)="onDragStart($event)"
                  (click)="onFormulaItemClick($event)">
                    {{ formula.name }}
                </div>
              </div>

              <div *ngIf="selectedCategoryItem.slug === 'concept'">
                <div 
                  *ngFor="let concept of concepts; index as index" 
                  class="pickable-badge no-selectable param numeric-param"
                  [id]="'concept-' + index + 1"
                  [attr.data-payload]="concept | json"
                  [attr.data-type]="'numeric'"
                  draggable="true"
                  (dragstart)="onDragStart($event)"
                  (click)="onFormulaItemClick($event)">
                    {{ concept.nombre }}
                </div>
              </div>

              <div *ngIf="selectedCategoryItem.slug === 'input-params'">
                <div 
                  *ngFor="let param of inputParams; index as index" 
                  class="pickable-badge no-selectable param numeric-param"
                  [id]="'param-' + index + 1"
                  [attr.data-payload]="param | json"
                  [attr.data-type]="'numeric'"
                  draggable="true"
                  (dragstart)="onDragStart($event)"
                  (click)="onFormulaItemClick($event)">
                    {{ param.name }}
                </div>
              </div>

              <div *ngIf="selectedCategoryItem.slug === 'standard-formulas'">
                <div 
                  *ngFor="let formula of standardFormulas; index as index" 
                  class="pickable-badge no-selectable param numeric-param"
                  [id]="'standard-formula-' + index + 1"
                  [attr.data-payload]="formula | json"
                  [attr.data-type]="'numeric'"
                  draggable="true"
                  (dragstart)="onDragStart($event)"
                  (click)="onFormulaItemClick($event)">
                    {{ formula.name }}
                </div>
              </div>

              <div *ngIf="selectedCategoryItem.slug === 'user-formulas'">
                <div 
                  *ngFor="let formula of userFormulas; index as index" 
                  class="pickable-badge no-selectable param numeric-param"
                  [id]="'user-formula-' + index + 1"
                  [attr.data-payload]="formula | json"
                  [attr.data-type]="'numeric'"
                  draggable="true"
                  (dragstart)="onDragStart($event)"
                  (click)="onFormulaItemClick($event)">
                    {{ formula.name }}
                </div>
              </div>

            </div>
          </div>
    
        </div>
      </div>
    </div>
  </div>
  <div class="collapse-badge-container" (click)="onExpandClick()">
    <div *ngIf="isExpanded; else expand" class="badge">
      <mat-icon>keyboard_arrow_left</mat-icon>
      Plegar
    </div>
    <ng-template #expand>
      <div class="badge">
        Abrir
        <mat-icon>keyboard_arrow_right</mat-icon>
      </div>
    </ng-template>
  </div>
</div>
